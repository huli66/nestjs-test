<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/axios@0.24.0/dist/axios.min.js"></script>
    <script src="https://unpkg.com/qs@6.10.2/dist/qs.js"></script>
    <title>Nest.js</title>
</head>
<body>
    <h1>Nest.js</h1>
    <button onclick="getImage(1)">getImage</button>
    <button onclick="urlParam(1)">Fetch Person</button>
    <button onclick="urlQuery()">urlQuery</button>
    <button onclick="postBody()">postBody</button>
    <button onclick="postJSON()">postJSON</button>
    <input type="file" multiple id="file-input">
    <script>
        async function getImage() {
            const res = await axios.get('/test/tt');
            console.log('res', res);
        }
        async function urlParam(id) {
            const res = await axios.get('/api/person/1');
            console.log(res);
        }

        async function urlQuery() {
            const res = await axios.get(`/api/person/find?name=hjj&age=18`, {
                params: {
                    name: 'lx',
                    age: '999'
                },
                data: {body: ''}
            });
            // axios.get 的 params 和 url 里的参数会逗号分隔拼接在一起
            console.log(res);
        }

        async function postBody() {
            console.log(await axios.post('/api/person', Qs.stringify({
                name: 'hl',
                age: 666
            }), {
                headers: {
                    'content-type': 'application/x-www-form-urlencoded'
                }
            }));
        }

        async function postJSON() {
            const res = await axios.post('/api/person', {
                name: 'hello',
                age: 6
            });
            console.log(res);
        }

        const fileInput = document.querySelector('#file-input');
        async function postFile() {
            const data = new FormData();
            data.set('name', 'hhh');
            data.set('age', 20);
            data.set('file1', fileInput.files[0]);
            data.set('file2', fileInput.files[1]);

            const res = await axios.post('/api/person/file', data, {
                headers: {
                    'content-type': 'multipart/form-data'
                }
            });
            console.log('res', res);
        }
        fileInput.onchange = postFile;
    </script>
</body>
</html>